#!/bin/bash
# SPDX-License-Identifier: AGPL-3.0-or-later
# SPDX-FileCopyrightText: 2025 Jonathan D.A. Jewell
# terrapin-ssg pre-push hook

set -e

echo "ðŸ¢ Running pre-push checks..."

# Run full CI if just is available
if command -v just >/dev/null 2>&1; then
    echo "  Running just ci..."
    just ci
else
    echo "  just not available, running manual checks..."

    # Language check
    forbidden=$(find src/ -type f \( -name "*.py" -o -name "*.js" -o -name "*.ts" \) 2>/dev/null || true)
    if [ -n "$forbidden" ]; then
        echo "ERROR: Found forbidden language files"
        exit 1
    fi

    # Logo file check
    if [ ! -f src/terrapin-ssg.logo ]; then
        echo "ERROR: Logo engine file missing"
        exit 1
    fi
fi

echo "âœ“ Pre-push checks passed"
